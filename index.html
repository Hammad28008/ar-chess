<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Chess - Live Camera</title>
    <!-- A-Frame library for 3D -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- AR.js for camera tracking -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        /* Fullscreen AR view */
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        /* Loading message */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            z-index: 1000;
            background: rgba(0,0,0,0.7);
            padding: 20px;
            border-radius: 10px;
        }
        
        /* Instructions */
        .instructions {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            text-align: center;
            color: white;
            font-size: 18px;
            z-index: 1000;
            background: rgba(0,0,0,0.5);
            padding: 10px;
        }
    </style>
</head>
<body>
    <!-- Loading message -->
    <div class="loading" id="loading">
        Loading AR Camera... Please allow camera access
    </div>
    
    <!-- Instructions -->
    <div class="instructions">
        Point camera at a flat surface. Tap to place chess board.
    </div>
    
    <!-- A-Frame AR Scene -->
    <a-scene 
        vr-mode-ui="enabled: false" 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false;"
    >
        <!-- AR Marker - This adds camera and AR capabilities -->
        <a-entity camera></a-entity>
        
        <!-- Your 3D Cube (will replace with chess later) -->
        <a-box 
            id="myCube"
            position="0 0.5 -2" 
            rotation="0 45 0"
            color="#FF5733"
            depth="0.5"
            height="0.5"
            width="0.5"
            shader="flat"
        >
            <!-- Text label above cube -->
            <a-text 
                value="Future Chess Board" 
                position="0 1 0" 
                color="#FFFFFF"
                align="center"
                width="3"
            ></a-text>
            
            <!-- Small instruction text -->
            <a-text 
                value="Tap me to rotate!" 
                position="0 -0.8 0" 
                color="#00FF00"
                align="center"
                width="2"
                scale="0.5 0.5 0.5"
            ></a-text>
        </a-box>
        
        <!-- Simple floor for reference -->
        <a-plane 
            position="0 0 -4" 
            rotation="-90 0 0" 
            width="4" 
            height="4" 
            color="#7BC8A4"
            opacity="0.5"
        ></a-plane>
        
        <!-- Light source so we can see the cube -->
        <a-light type="ambient" color="#FFFFFF"></a-light>
        <a-light type="directional" position="2 5 3" intensity="0.8"></a-light>
    </a-scene>
    
    <!-- JavaScript for interaction -->
    <script>
        // Wait for everything to load
        window.addEventListener('load', function() {
            // Hide loading message after 2 seconds
            setTimeout(function() {
                document.getElementById('loading').style.display = 'none';
            }, 2000);
            
            // Get the cube element
            var cube = document.getElementById('myCube');
            
            // Make cube clickable/tappable
            cube.addEventListener('click', function() {
                // Get current rotation
                var currentRotation = cube.getAttribute('rotation');
                
                // Rotate 90 degrees on Y axis
                cube.setAttribute('rotation', {
                    x: currentRotation.x,
                    y: currentRotation.y + 90,
                    z: currentRotation.z
                });
                
                // Change color for feedback
                var colors = ['#FF5733', '#33FF57', '#3357FF', '#F3FF33'];
                var randomColor = colors[Math.floor(Math.random() * colors.length)];
                cube.setAttribute('color', randomColor);
            });
            
            // Add mouse hover effect (for desktop testing)
            cube.addEventListener('mouseenter', function() {
                cube.setAttribute('scale', '1.1 1.1 1.1');
            });
            
            cube.addEventListener('mouseleave', function() {
                cube.setAttribute('scale', '1 1 1');
            });
            
            // Camera permission check
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function(stream) {
                    console.log("Camera access granted");
                })
                .catch(function(err) {
                    document.getElementById('loading').innerHTML = 
                        "Camera access denied. Please allow camera to use AR.<br>" +
                        "Refresh page and click 'Allow' when prompted.";
                });
        });
    </script>
</body>
</html>